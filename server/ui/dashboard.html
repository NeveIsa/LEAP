<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="style/main.css" />
</head>
<body class="page-centered">
    <div class="dashboard-container">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:16px;">
            <h1 style="margin:0;">Admin Dashboard</h1>
            <button id="logout-btn" class="btn">Logout</button>
        </div>
        <div class="links-grid">
            <a href="students.html" class="dashboard-link">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                Students
            </a>
            <a href="logs.html" class="dashboard-link">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 5h18v2H3V5zm0 6h18v2H3v-2zm0 6h18v2H3v-2z"/></svg>
                Logs List
            </a>
            <a href="viz/lineplot.html" class="dashboard-link">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h4v-4zm0-6h-4v4h4V7zM7 7h4v4H7V7zm0 6h4v4H7v-4z"/></svg>
                Log Visualization
            </a>
            <a href="random.html" class="dashboard-link">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z"/></svg>
                Random Actions
            </a>
            <a href="#" class="dashboard-link">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                Future Features
            </a>
        </div>
    </div>

    <script>
        const API_BASE_URL = window.location.origin;

        // Require authentication to view dashboard
        (async () => {
            try {
                const resp = await fetch(`${API_BASE_URL}/admin/ping`, { credentials: 'include' });
                if (!resp.ok) {
                    window.location.href = 'login.html';
                }
            } catch (e) {
                // On network error, err on the side of redirecting to login
                window.location.href = 'login.html';
            }
        })();

        // Logout button handler
        const logoutBtn = document.getElementById('logout-btn');
        logoutBtn?.addEventListener('click', async () => {
            try {
                await fetch(`${API_BASE_URL}/admin/logout`, { method: 'POST', credentials: 'include' });
            } catch (e) { /* ignore */ }
            window.location.href = 'login.html';
        });
    </script>
</body>
</html>
